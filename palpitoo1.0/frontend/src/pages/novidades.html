<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Palpitoo - Novidades</title>
  <link rel="stylesheet" href="./css/style.css">

  <style>
    .feed-item {
      display: flex;
      gap: 14px;
      padding: 16px;
      background: var(--bg-dark);
      border-radius: 14px;
      border: 1px solid var(--borda-divisoria);
      margin-bottom: 10px;
      transition: border-color 0.2s ease, transform 0.2s ease;
      animation: fadeSlide 0.4s ease forwards;
      opacity: 0;
    }
    .feed-item:hover { border-color: var(--accent-cyan); transform: translateX(3px); }
    @keyframes fadeSlide {
      from { opacity: 0; transform: translateY(10px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .feed-item.tipo-pessoal { border-left: 3px solid var(--accent-cyan); }
    .feed-item.tipo-liga    { border-left: 3px solid var(--accent-green); }
    .feed-item.tipo-sistema { border-left: 3px solid #eab308; }
    .feed-item.tipo-pato    { border-left: 3px solid var(--accent-cyan); background: rgba(192,52,90,0.05); }

    .feed-icone {
      font-size: 22px;
      width: 42px; height: 42px;
      flex-shrink: 0;
      background: var(--bg-header);
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      border: 1px solid var(--borda-divisoria);
    }
    .feed-corpo { flex-grow: 1; }
    .feed-titulo    { font-family: 'Russo One', sans-serif; font-size: 14px; color: var(--text-white); margin-bottom: 4px; }
    .feed-descricao { font-size: 13px; color: var(--text-gray); line-height: 1.5; }
    .feed-tempo     { font-size: 10px; color: var(--text-gray); margin-top: 6px; text-transform: uppercase; font-weight: 700; letter-spacing: 1px; }

    .filtro-btn {
      padding: 7px 16px; border-radius: 20px;
      font-family: 'Russo One', sans-serif; font-size: 11px; text-transform: uppercase;
      border: 1px solid var(--borda-divisoria); background: var(--bg-dark);
      color: var(--text-gray); cursor: pointer; transition: all 0.2s;
    }
    .filtro-btn:hover { border-color: var(--accent-cyan); color: var(--text-white); }
    .filtro-btn.ativo { background: var(--accent-cyan); color: #fff; border-color: var(--accent-cyan); }

    .regra-linha {
      display: flex; justify-content: space-between; align-items: center;
      padding: 12px 0; border-bottom: 1px dashed var(--borda-divisoria);
    }
    .regra-linha:last-child { border-bottom: none; }

    .badge-tipo {
      font-family: 'Russo One', sans-serif; font-size: 9px;
      padding: 2px 8px; border-radius: 20px;
      text-transform: uppercase; letter-spacing: 1px;
      display: inline-block; margin-bottom: 4px;
    }
    .badge-pessoal { background: rgba(192,52,90,0.2);  color: var(--accent-cyan); border: 1px solid var(--accent-cyan); }
    .badge-liga    { background: rgba(34,197,94,0.15); color: #4ade80;            border: 1px solid #4ade80; }
    .badge-sistema { background: rgba(234,179,8,0.15); color: #eab308;            border: 1px solid #eab308; }
    .badge-pato    { background: rgba(192,52,90,0.2);  color: var(--accent-cyan); border: 1px solid var(--accent-cyan); }
  </style>
  <meta name="description" content="Palpitoo ‚Äî A Resenha Virou Campeonato. Palpites de futebol com amigos.">
  <link rel="icon" href="./img/pato.png" type="image/png">
</head>
<body>

  <header class="navbar">
    <a href="inicio.html" class="logo-link">
      <img src="./img/pato.png" alt="Logo Palpitoo" class="logo-imagem">
    </a>
    <nav>
      <ul class="nav-links">
        <li><a href="index.html">In√≠cio</a></li>
        <li><a href="ligas.html">Ligas</a></li>
        <li><a href="palpites.html">Palpites</a></li>
        <li><a href="novidades.html" class="ativo">Novidades</a></li>
        <li><a href="social.html">Social</a></li>
        <li><a href="carreira.html">Carreira</a></li>
      </ul>
    </nav>
    <button class="hamburger" id="hamburger-btn" aria-label="Menu">
      <span></span><span></span><span></span>
    </button>
    <div class="navbar-user" id="navbar-user-area"></div>
  </header>

  <main class="container-principal" style="max-width: 960px; margin-top: 40px;">

    <div class="text-center mb-20 animacao-suave">
      <h2 class="font-russo titulo-branco" style="font-size: 32px;">Central da <span style="color: var(--accent-cyan);">Palpitoo</span></h2>
      <p style="color: var(--text-gray); font-size: 15px;">Feed da liga, notifica√ß√µes pessoais e decretos do Pato Mestre</p>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 320px; gap: 30px; align-items: start;">

      <!-- FEED -->
      <div>
        <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 20px;">
          <button class="filtro-btn ativo" onclick="filtrar('todos', this)">üåê Todos</button>
          <button class="filtro-btn" onclick="filtrar('pessoal', this)">üë§ Pessoal</button>
          <button class="filtro-btn" onclick="filtrar('liga', this)">‚öîÔ∏è Liga</button>
          <button class="filtro-btn" onclick="filtrar('sistema', this)">‚öôÔ∏è Sistema</button>
          <button class="filtro-btn" onclick="filtrar('pato', this)">ü¶Ü Pato</button>
        </div>
        <div id="feed-container">
          <p class="text-center font-russo" style="color: var(--text-gray); margin-top: 30px;">Carregando novidades... üîÑ</p>
        </div>
      </div>

      <!-- SIDEBAR -->
      <div style="display: flex; flex-direction: column; gap: 20px;">

        <section class="cartao bg-escuro animacao-suave" style="border-top: 3px solid var(--text-white);">
          <h3 class="font-russo titulo-branco mb-15" style="font-size: 17px;">‚öñÔ∏è Regulamento</h3>
          <div class="divisor-tracejado mb-15"></div>
          <p class="font-russo" style="font-size: 13px; color: var(--text-gray); margin-bottom: 12px; text-transform: uppercase;">üéØ Pontua√ß√£o</p>
          <div style="background: var(--bg-dark); padding: 14px; border-radius: 12px; border: 1px solid var(--borda-divisoria);">
            <div class="regra-linha">
              <span style="font-size: 13px; color: var(--text-white);">Placar exato</span>
              <span class="font-russo" style="color: var(--accent-cyan);">+3 PTS</span>
            </div>
            <div class="regra-linha">
              <span style="font-size: 13px; color: var(--text-white);">Acertar vencedor</span>
              <span class="font-russo" style="color: var(--accent-green);">+1 PT</span>
            </div>
            <div class="regra-linha">
              <span style="font-size: 13px; color: var(--text-gray);">Errar tudo</span>
              <span class="font-russo" style="color: var(--vermelho);">0 PTS</span>
            </div>
          </div>
          <p class="font-russo" style="font-size: 13px; color: var(--text-gray); margin-top: 16px; margin-bottom: 12px; text-transform: uppercase;">üèÜ Premia√ß√£o</p>
          <div style="background: var(--bg-dark); padding: 14px; border-radius: 12px; border: 1px solid #eab308; text-align: center;">
            <p style="color: #eab308; font-size: 13px; margin: 0; line-height: 1.5;">O Campe√£o leva a <strong>Ta√ßa Pato de Ouro</strong> e a gl√≥ria eterna!</p>
          </div>
        </section>

        <section class="cartao bg-escuro animacao-suave">
          <h3 class="font-russo titulo-branco mb-15" style="font-size: 17px;">üìå Legenda do Feed</h3>
          <div class="divisor-tracejado mb-15"></div>
          <div style="display: flex; flex-direction: column; gap: 10px;">
            <div style="display: flex; align-items: center; gap: 10px;">
              <div style="width: 4px; height: 36px; background: var(--accent-cyan); border-radius: 2px; flex-shrink: 0;"></div>
              <div><p class="font-russo" style="font-size: 12px; color: var(--text-white);">Pessoal</p><p style="font-size: 11px; color: var(--text-gray);">Suas posi√ß√µes, pontos e conquistas</p></div>
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
              <div style="width: 4px; height: 36px; background: var(--accent-green); border-radius: 2px; flex-shrink: 0;"></div>
              <div><p class="font-russo" style="font-size: 12px; color: var(--text-white);">Liga</p><p style="font-size: 11px; color: var(--text-gray);">Resultados, rodadas e eventos da liga</p></div>
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
              <div style="width: 4px; height: 36px; background: #eab308; border-radius: 2px; flex-shrink: 0;"></div>
              <div><p class="font-russo" style="font-size: 12px; color: var(--text-white);">Sistema</p><p style="font-size: 11px; color: var(--text-gray);">Atualiza√ß√µes e novidades do Palpitoo</p></div>
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
              <div style="width: 4px; height: 36px; background: var(--accent-cyan); border-radius: 2px; flex-shrink: 0;"></div>
              <div><p class="font-russo" style="font-size: 12px; color: var(--text-white);">ü¶Ü Decreto do Pato</p><p style="font-size: 11px; color: var(--text-gray);">Julgamentos autom√°ticos do Pato Mestre</p></div>
            </div>
          </div>
        </section>

      </div>
    </div>
  </main>

  <div id="container-avisos"></div>

<script>
  const idLogado   = localStorage.getItem('craqueId') || localStorage.getItem('id_craque');
  const nomeLogado = localStorage.getItem('nome_craque') || 'Craque';
  const primeiro   = nomeLogado.split(' ')[0];

  let filtroAtivo    = 'todos';
  let todosFeedItens = [];

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  //  BANCO DE FRASES ‚Äî PATO MESTRE
  //  Cada situa√ß√£o tem pelo menos 3 varia√ß√µes. A fun√ß√£o
  //  pega(arr) sorteia uma diferente a cada carregamento.
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  const pega = arr => arr[Math.floor(Math.random() * arr.length)];

  const FRASES = {

    // ‚îÄ‚îÄ Subiu 2 posi√ß√µes ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    subiu2: [
      (n, pos) => `"${n}, subiu 2 posi√ß√µes e agora est√° em ${pos}¬∫. Mas n√£o venha me pedir parab√©ns ‚Äî isso √© obriga√ß√£o."`,
      (n, pos) => `"Dois degraus de uma vez, ${n}? Quase me impressionou. Falta s√≥ mais ${pos - 1} pra chegar onde eu mando."`,
      (n, pos) => `"${n} escalou 2 posi√ß√µes. O ranking notou. Eu tamb√©m. N√£o deixa cair de volta, porque vou zoar muito."`,
    ],

    // ‚îÄ‚îÄ Subiu 3+ posi√ß√µes ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    subiu3mais: [
      (n, delta, pos) => `"ATEN√á√ÉO GERAL: ${n} subiu ${delta} posi√ß√µes de uma vez! Isso n√£o √© palpite, isso √© macumba. T√¥ de olho em voc√™."`,
      (n, delta, pos) => `"${n} subiu ${delta} posi√ß√µes e chegou em ${pos}¬∫. O Pato Mestre oficialmente declara: essa rodada foi sua. S√≥ essa."`,
      (n, delta, pos) => `"${delta} posi√ß√µes de subida, ${n}?! A galera deve estar em choque. Eu tamb√©m t√¥, mas n√£o vou admitir."`,
    ],

    // ‚îÄ‚îÄ Mitada (8+ pontos na rodada) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    mitada: [
      (n, pts) => `"${pts} pontos em uma rodada s√≥, ${n}?! O Pato Mestre decreta: isso foi uma mitada hist√≥rica. N√£o estrague na pr√≥xima."`,
      (n, pts) => `"${n} fez ${pts} pontos nessa rodada. ${pts >= 12 ? 'Isso √© humano? Algu√©m checa os palpites desse a√≠.' : 'T√° bom demais pra ser verdade. O Pato desconfia.'}"`,
      (n, pts) => `"DECRETO URGENTE: ${n} acumulou ${pts} pts nessa rodada. A liga inteira j√° te odeia. Parab√©ns e tome cuidado."`,
      (n, pts) => `"${pts} pontos numa rodada, ${n}. Digno de um veterano da Brah.Bet. N√£o que eu v√° falar isso na sua cara, mas... t√° dito."`,
    ],

    // ‚îÄ‚îÄ Rodada zerada (0 pontos) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    zero: [
      n => `"${n}... zero pontos. ZERO. Voc√™ palpitou ou jogou uma moeda? Porque a moeda iria errar menos."`,
      n => `"Rodada zerada, ${n}. O Pato Mestre decreta: voc√™ √© oficialmente o bagre da rodada. T√≠tulo vital√≠cio por enquanto."`,
      n => `"0 pts nessa rodada, ${n}. Eu tentei te avisar. Mas voc√™ n√£o ouviu. Agora senta e reflete o que fez de errado."`,
      n => `"${n} zerou a rodada. Eu n√£o vou rir. Vou s√≥ anotar aqui no arquivo dos bagres hist√≥ricos da liga. Segue."`,
    ],

    // ‚îÄ‚îÄ Lideran√ßa ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    lider: [
      n => `"DECRETO M√ÅXIMO: ${n} lidera o ranking. Aproveite enquanto dura, porque o Pato Mestre j√° escalou quem vai te destronar."`,
      n => `"${n} no topo da tabela. Bonito. Mas j√° vi l√≠der despencar em duas rodadas. O Pato n√£o esquece."`,
      n => `"Olha quem t√° na ponta, ${n}! N√£o sei se isso √© m√©rito ou sorte sua. Prefiro achar que √© sorte ‚Äî fica mais divertido."`,
    ],

    // ‚îÄ‚îÄ Lanterna ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    lanterna: [
      (n, pos, total) => `"${n} est√° em ${pos}¬∫ de ${total}. Lanterna oficial. O Pato Mestre decreta: voc√™ tem muito trabalho pela frente, bagre."`,
      (n, pos, total) => `"√öltimo lugar, ${n}. √öLTIMO. Isso √© dif√≠cil de conseguir ‚Äî tem que errar com consist√™ncia. Respeito, de certo modo."`,
      (n, pos, total) => `"${n} fecha o ranking em ${pos}¬∫. O trof√©u de Pato Mestre da liga √© seu por enquanto. N√£o √© um pr√™mio que voc√™ quer guardar."`,
    ],

    // ‚îÄ‚îÄ P√≥dio (2¬∫ ou 3¬∫ lugar) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    podio: [
      (n, pos) => `"${n} no p√≥dio, ${pos}¬∫ lugar! Falta pouco pra derrubar o l√≠der. O Pato autoriza a tentativa."`,
      (n, pos) => `"Top ${pos} do ranking, ${n}. N√£o to mal impressionado. Vamos ver se voc√™ aguenta a press√£o nas pr√≥ximas rodadas."`,
      (n, pos) => `"${pos}¬∫ lugar, ${n}. Voc√™ est√° perturbando o sono do l√≠der. Continue perturbando ‚Äî √© o que o Pato gosta de ver."`,
    ],

    // ‚îÄ‚îÄ Aproveitamento alto (50%+ de crava√ß√µes) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    aproveitamentoAlto: [
      (n, taxa) => `"${taxa}% de crava√ß√µes, ${n}?! Ou voc√™ tem uma bola de cristal, ou voc√™ t√° assistindo a todos os treinos. Suspeito."`,
      (n, taxa) => `"O Pato decreta: ${taxa}% de placar exato √© o tipo de coisa que faz os outros bagres da liga perderem o sono. Bom."`,
      (n, taxa) => `"${n} est√° cravando ${taxa}% dos placares. Isso n√£o √© palpite ‚Äî isso √© ci√™ncia. Ou trapa√ßa. Vou apurar."`,
    ],

    // ‚îÄ‚îÄ Aproveitamento zero (0% de crava√ß√µes) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    aproveitamentoZero: [
      n => `"Nenhuma crava√ß√£o ainda, ${n}. O Pato Mestre informa: acertar s√≥ o vencedor √© o m√≠nimo. Tente dar uma olhada nos jogos antes de palpitar."`,
      n => `"Zero crava√ß√µes, ${n}. Voc√™ palpita de olho fechado? Porque fechado aberto t√° dando na mesma. Abre o olho."`,
      n => `"${n} ainda n√£o acertou um placar exato sequer. O Pato Mestre registra oficialmente: isso √© triste. Mas recuper√°vel. Por enquanto."`,
    ],

    // ‚îÄ‚îÄ Primeiro palpite / sem jogos encerrados ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    semJogos: [
      n => `"${n}! A temporada come√ßou e voc√™ ainda n√£o tem resultado nenhum. O Pato n√£o vai esperar ‚Äî vai logo palpitar antes que eu decrete bagre precoce."`,
      n => `"Nenhum jogo encerrado ainda, ${n}. O Pato aguarda. Com paci√™ncia finita."`,
      n => `"${n}, seus palpites ainda n√£o foram julgados pela bola. Mas j√° foram julgados pelo Pato. E o veredicto sai em breve."`,
    ],

    // ‚îÄ‚îÄ Aproveitamento m√©dio ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    aproveitamentoMedio: [
      (n, taxa) => `"${taxa}% de crava√ß√µes, ${n}. T√° no meio do caminho entre genial e bagre. O Pato observa, sem dar nota ainda."`,
      (n, taxa) => `"Apenas ${taxa}% de placar exato, ${n}. N√£o √© feio, n√£o √© bonito. √â med√≠ocre. O Pato exige mais."`,
      (n, taxa) => `"${taxa}% das crava√ß√µes convertidas, ${n}. Isso n√£o me emociona. O torcedor meia-boca da arquibancada acerta mais."`,
    ],

    // ‚îÄ‚îÄ Sequ√™ncia positiva (3+ jogos acertando pelo menos 1pt) ‚îÄ‚îÄ
    sequencia: [
      (n, seq) => `"${n} pontuou em ${seq} jogos seguidos! O Pato Mestre decreta: isso n√£o √© sorte. √â consist√™ncia. E me irrita."`,
      (n, seq) => `"${seq} jogos seguidos pontuando, ${n}. O ranking inteiro j√° come√ßou a te olhar diferente. Eu tamb√©m. N√£o √© elogio ‚Äî √© alerta."`,
      (n, seq) => `"Sequ√™ncia de ${seq} jogos no positivo, ${n}. Segue assim e vai ter que me passar na frente do ranking. O Pato t√° avisado."`,
    ],

    // ‚îÄ‚îÄ Servidor offline ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    offline: [
      n => `"Servidor offline, ${n}. Nem eu consigo decretar nada agora. Volta mais tarde ‚Äî o Pato precisa de conex√£o para julgar."`,
      n => `"${n}, o servidor dormiu antes de mim. Raro. Tente novamente em instantes ‚Äî os decretos n√£o v√£o esperar pra sempre."`,
      n => `"Queda de servidor, ${n}. At√© o Pato Mestre tem seus limites t√©cnicos. Mas os bagres continuam sendo bagres offline tamb√©m."`,
    ],

  };

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  //  DECRETOS DO PATO ‚Äî l√≥gica principal
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  function gerarDecretosPato(dados) {
    const { palpites, ranking, posAnterior } = dados;
    const decretos = [];

    const finalizados = palpites.filter(p => p.pontos_obtidos !== null);
    const posAtual    = ranking ? ranking.findIndex(r => String(r.id) === String(idLogado)) : -1;

    // ‚îÄ‚îÄ Subida de posi√ß√µes ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    if (posAnterior !== null && posAnterior !== undefined && posAtual !== -1) {
      const delta = posAnterior - posAtual; // positivo = subiu
      if (delta >= 3) {
        decretos.push({
          tipo: 'pato', icone: 'üöÄ', badge: 'Decreto do Pato',
          titulo: `Subiu ${delta} posi√ß√µes!`,
          descricao: pega(FRASES.subiu3mais)(primeiro, delta, posAtual + 1),
          tempo: 'Ap√≥s √∫ltima rodada'
        });
      } else if (delta === 2) {
        decretos.push({
          tipo: 'pato', icone: 'üìà', badge: 'Decreto do Pato',
          titulo: `Subiu 2 posi√ß√µes!`,
          descricao: pega(FRASES.subiu2)(primeiro, posAtual + 1),
          tempo: 'Ap√≥s √∫ltima rodada'
        });
      }
    }

    // ‚îÄ‚îÄ Pontua√ß√£o da √∫ltima rodada ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const ultimaRodada = finalizados.length > 0
      ? Math.max(...finalizados.map(p => p.rodada || p.numero_rodada || 1))
      : null;

    if (ultimaRodada) {
      const jogosUltimaRodada = finalizados.filter(p => (p.rodada || p.numero_rodada || 1) === ultimaRodada);
      const ptsRodada = jogosUltimaRodada.reduce((s, p) => s + (p.pontos_obtidos || 0), 0);

      if (ptsRodada >= 8) {
        decretos.push({
          tipo: 'pato', icone: 'üî•', badge: 'Decreto do Pato',
          titulo: `Mitada na Rodada ${ultimaRodada}!`,
          descricao: pega(FRASES.mitada)(primeiro, ptsRodada),
          tempo: `Rodada ${ultimaRodada}`
        });
      } else if (ptsRodada === 0 && jogosUltimaRodada.length > 0) {
        decretos.push({
          tipo: 'pato', icone: 'ü¶Ü', badge: 'Decreto do Pato',
          titulo: `Rodada ${ultimaRodada} zerada`,
          descricao: pega(FRASES.zero)(primeiro),
          tempo: `Rodada ${ultimaRodada}`
        });
      }
    }

    // ‚îÄ‚îÄ Posi√ß√£o no ranking ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    if (posAtual === 0) {
      decretos.push({
        tipo: 'pato', icone: 'üèÜ', badge: 'Decreto do Pato',
        titulo: 'Decreto de Lideran√ßa!',
        descricao: pega(FRASES.lider)(primeiro),
        tempo: 'Agora'
      });
    } else if (posAtual === 1 || posAtual === 2) {
      decretos.push({
        tipo: 'pato', icone: 'ü•à', badge: 'Decreto do Pato',
        titulo: `Voc√™ est√° no p√≥dio! (${posAtual + 1}¬∫)`,
        descricao: pega(FRASES.podio)(primeiro, posAtual + 1),
        tempo: 'Agora'
      });
    } else if (ranking && posAtual === ranking.length - 1 && ranking.length > 2) {
      decretos.push({
        tipo: 'pato', icone: 'ü™£', badge: 'Decreto do Pato',
        titulo: 'Lanterna oficial ü™£',
        descricao: pega(FRASES.lanterna)(primeiro, posAtual + 1, ranking.length),
        tempo: 'Agora'
      });
    }

    // ‚îÄ‚îÄ Aproveitamento de crava√ß√µes ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    if (finalizados.length >= 3) {
      const cravadas = finalizados.filter(p => p.pontos_obtidos === 3).length;
      const taxa     = Math.round((cravadas / finalizados.length) * 100);

      if (taxa >= 50) {
        decretos.push({
          tipo: 'pato', icone: 'üéØ', badge: 'Decreto do Pato',
          titulo: `${taxa}% de crava√ß√µes!`,
          descricao: pega(FRASES.aproveitamentoAlto)(primeiro, taxa),
          tempo: 'Esta temporada'
        });
      } else if (taxa === 0) {
        decretos.push({
          tipo: 'pato', icone: 'üò¨', badge: 'Decreto do Pato',
          titulo: 'Nenhuma crava√ß√£o ainda',
          descricao: pega(FRASES.aproveitamentoZero)(primeiro),
          tempo: 'Esta temporada'
        });
      } else {
        decretos.push({
          tipo: 'pato', icone: 'ü¶Ü', badge: 'Decreto do Pato',
          titulo: `${taxa}% de aproveitamento`,
          descricao: pega(FRASES.aproveitamentoMedio)(primeiro, taxa),
          tempo: 'Esta temporada'
        });
      }
    }

    // ‚îÄ‚îÄ Sem jogos encerrados ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    if (finalizados.length === 0) {
      decretos.push({
        tipo: 'pato', icone: 'ü¶Ü', badge: 'Decreto do Pato',
        titulo: 'O Pato aguarda...',
        descricao: pega(FRASES.semJogos)(primeiro),
        tempo: 'Agora'
      });
    }

    // ‚îÄ‚îÄ Sequ√™ncia positiva ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    if (finalizados.length >= 3) {
      // Detecta sequ√™ncia de jogos consecutivos com pelo menos 1 ponto
      const ordenados = [...finalizados].sort((a, b) => (b.rodada || 0) - (a.rodada || 0));
      let seq = 0;
      for (const p of ordenados) {
        if ((p.pontos_obtidos || 0) > 0) seq++;
        else break;
      }
      if (seq >= 3) {
        decretos.push({
          tipo: 'pato', icone: '‚ö°', badge: 'Decreto do Pato',
          titulo: `Sequ√™ncia de ${seq} jogos pontuando!`,
          descricao: pega(FRASES.sequencia)(primeiro, seq),
          tempo: 'Esta temporada'
        });
      }
    }

    return decretos;
  }

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  //  FEED PESSOAL
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  function gerarFeedPessoal(palpites, ranking) {
    const itens       = [];
    const finalizados = palpites.filter(p => p.pontos_obtidos !== null);

    if (finalizados.length > 0) {
      const totalPontos = finalizados.reduce((s, p) => s + (p.pontos_obtidos || 0), 0);
      const cravadas    = finalizados.filter(p => p.pontos_obtidos === 3).length;
      const naTraves    = finalizados.filter(p => p.pontos_obtidos === 1).length;
      const erros       = finalizados.filter(p => p.pontos_obtidos === 0).length;

      if (cravadas > 0) {
        itens.push({
          tipo: 'pessoal', icone: 'üéØ', badge: 'Pessoal',
          titulo: `${cravadas} crava√ß√£o${cravadas > 1 ? '√µes' : ''} na temporada!`,
          descricao: `Voc√™ acertou o placar exato em ${cravadas} jogo${cravadas > 1 ? 's' : ''} (+${cravadas * 3} pts). ${naTraves > 0 ? `Mais ${naTraves} acerto${naTraves > 1 ? 's' : ''} de resultado (+${naTraves} pt${naTraves > 1 ? 's' : ''}).` : ''}`,
          tempo: 'Esta temporada'
        });
      }

      itens.push({
        tipo: 'pessoal', icone: 'üìä', badge: 'Pessoal',
        titulo: `${totalPontos} pontos acumulados`,
        descricao: `${finalizados.length} jogo${finalizados.length > 1 ? 's' : ''} encerrado${finalizados.length > 1 ? 's' : ''}: ${cravadas} crava√ß√£o${cravadas !== 1 ? '√µes' : ''}, ${naTraves} na trave, ${erros} erro${erros !== 1 ? 's' : ''}. ${erros > 0 ? 'ü§´ N√£o conta pra ningu√©m.' : 'üëè Clean sheet de erros!'}`,
        tempo: 'Esta temporada'
      });

      // Posi√ß√£o
      if (ranking && ranking.length > 0) {
        const pos = ranking.findIndex(r => String(r.id) === String(idLogado));
        if (pos !== -1) {
          const emojis = ['ü•á','ü•à','ü•â'];
          const emoji  = pos < 3 ? emojis[pos] : 'üìç';
          const texto  = pos === 0
            ? 'Voc√™ lidera o ranking! Mas n√£o relaxe, a temporada n√£o acabou.'
            : pos <= 2
              ? 'Voc√™ est√° no p√≥dio do ranking. Continue firme!'
              : `Voc√™ ocupa a ${pos + 1}¬™ posi√ß√£o. Hora de apertar o passo!`;
          itens.push({
            tipo: 'pessoal', icone: emoji, badge: 'Pessoal',
            titulo: `${pos + 1}¬∫ lugar no ranking`,
            descricao: texto,
            tempo: 'Agora'
          });
        }
      }
    } else {
      itens.push({
        tipo: 'pessoal', icone: '‚öΩ', badge: 'Pessoal',
        titulo: 'Nenhum jogo encerrado ainda',
        descricao: 'Seus palpites ainda aguardam os resultados. Assim que os jogos encerrarem, sua pontua√ß√£o aparece aqui.',
        tempo: 'Agora'
      });
    }

    return itens;
  }

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  //  FEED DE LIGA
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  function gerarFeedLiga(jogos, ligaAtual) {
    const itens = [];

    const finalizados = jogos.filter(j => j.status === 'finalizado');
    const emAndamento = jogos.filter(j => j.status === 'em andamento');

    const rodadas = {};
    finalizados.forEach(j => {
      const r = j.rodada || 1;
      if (!rodadas[r]) rodadas[r] = [];
      rodadas[r].push(j);
    });

    Object.keys(rodadas).sort((a, b) => b - a).forEach(r => {
      const jogosRodada = rodadas[r];
      itens.push({
        tipo: 'liga', icone: 'üèÅ', badge: 'Liga',
        titulo: `Rodada ${r} encerrada!`,
        descricao: `${jogosRodada.length} jogo${jogosRodada.length > 1 ? 's' : ''} finalizado${jogosRodada.length > 1 ? 's' : ''}: ${jogosRodada.map(j => `${j.time_casa} ${j.gols_casa_real}x${j.gols_fora_real} ${j.time_fora}`).join(' ‚Ä¢ ')}`,
        tempo: `Rodada ${r}`
      });
    });

    if (emAndamento.length > 0) {
      const rodadaAtual = emAndamento[0].rodada || '?';
      itens.push({
        tipo: 'liga', icone: '‚ö°', badge: 'Liga',
        titulo: `Rodada ${rodadaAtual} em andamento`,
        descricao: `${emAndamento.length} jogo${emAndamento.length > 1 ? 's' : ''} aguardando resultado: ${emAndamento.map(j => `${j.time_casa} x ${j.time_fora}`).join(' ‚Ä¢ ')}`,
        tempo: 'Agora'
      });
    }

    if (ligaAtual) {
      itens.push({
        tipo: 'liga', icone: '‚öîÔ∏è', badge: 'Liga',
        titulo: `Voc√™ est√° na liga: ${ligaAtual}`,
        descricao: 'Acesse a p√°gina da sua liga para ver o ranking completo e os palpites da galera.',
        tempo: 'Esta temporada'
      });
    }

    return itens;
  }

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  //  FEED DE SISTEMA
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  function gerarFeedSistema() {
    return [
      {
        tipo: 'sistema', icone: 'üìñ', badge: 'Sistema',
        titulo: 'Hist√≥rico da Liga dispon√≠vel!',
        descricao: 'Agora em "Minha Liga" tem a aba Hist√≥rico: funda√ß√£o, frase marcante, temporada, pr√™mios encerrados e linha do tempo.',
        tempo: 'Novidade'
      },
      {
        tipo: 'sistema', icone: 'üîó', badge: 'Sistema',
        titulo: 'Ranking clic√°vel',
        descricao: 'Cada membro do ranking da liga agora √© clic√°vel ‚Äî vai direto pro perfil p√∫blico e carreira dele.',
        tempo: 'Novidade'
      },
      {
        tipo: 'sistema', icone: 'üë§', badge: 'Sistema',
        titulo: 'Perfil P√∫blico dispon√≠vel!',
        descricao: 'Visite o perfil de qualquer palpiteiro pelo Social e veja a carreira completa dele.',
        tempo: 'Dispon√≠vel'
      },
      {
        tipo: 'sistema', icone: 'üë•', badge: 'Sistema',
        titulo: 'Seguir Palpiteiros',
        descricao: 'Siga seus rivais na aba Social e acompanhe o desempenho deles em tempo real.',
        tempo: 'Dispon√≠vel'
      },
      {
        tipo: 'sistema', icone: '‚öôÔ∏è', badge: 'Sistema',
        titulo: 'Ligas Privadas com c√≥digo',
        descricao: 'Crie sua liga, convide os amigos com um c√≥digo exclusivo e dispute o ranking privado.',
        tempo: 'Dispon√≠vel'
      }
    ];
  }

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  //  RENDERIZAR
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  function renderizarFeed(itens) {
    const container = document.getElementById('feed-container');
    const filtrados  = filtroAtivo === 'todos' ? itens : itens.filter(i => i.tipo === filtroAtivo);

    if (!filtrados.length) {
      container.innerHTML = `<p class="text-center font-russo" style="color:var(--text-gray);margin-top:30px;">Nenhuma novidade nesta categoria ainda. ü¶Ü</p>`;
      return;
    }

    container.innerHTML = '';
    filtrados.forEach((item, idx) => {
      container.innerHTML += `
        <div class="feed-item tipo-${item.tipo}" style="animation-delay:${idx * 0.05}s;">
          <div class="feed-icone">${item.icone}</div>
          <div class="feed-corpo">
            <span class="badge-tipo badge-${item.tipo}">${item.badge}</span>
            <p class="feed-titulo">${item.titulo}</p>
            <p class="feed-descricao">${item.descricao}</p>
            <p class="feed-tempo">üïê ${item.tempo}</p>
          </div>
        </div>`;
    });
  }

  function filtrar(tipo, btn) {
    filtroAtivo = tipo;
    document.querySelectorAll('.filtro-btn').forEach(b => b.classList.remove('ativo'));
    btn.classList.add('ativo');
    renderizarFeed(todosFeedItens);
  }

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  //  MOTOR PRINCIPAL
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  async function carregarFeed() {
    try {
      const [resJogos, resPalpites, resRanking] = await Promise.all([
        fetch('https://palpitoo-api.onrender.com/jogos'),
        idLogado ? fetch(`https://palpitoo-api.onrender.com/meus-palpites/${idLogado}`) : Promise.resolve({ json: () => [] }),
        fetch('https://palpitoo-api.onrender.com/ranking')
      ]);

      const jogos    = await resJogos.json();
      const palpites = await resPalpites.json();
      const ranking  = await resRanking.json();

      let ligaAtual   = null;
      let posAnterior = null;

      if (idLogado) {
        try {
          const resLiga = await fetch(`https://palpitoo-api.onrender.com/minha-liga/${idLogado}`);
          const dLiga   = await resLiga.json();
          if (dLiga.liga) ligaAtual = dLiga.liga.nome;
        } catch(_) {}

        // Posi√ß√£o anterior pode vir do hist√≥rico ou de um endpoint espec√≠fico
        // Por enquanto guarda/l√™ no sessionStorage para comparar entre rodadas
        const posAtual = ranking.findIndex(r => String(r.id) === String(idLogado));
        const chave    = `pos_anterior_${idLogado}`;
        posAnterior    = sessionStorage.getItem(chave) !== null ? parseInt(sessionStorage.getItem(chave)) : null;
        if (posAtual !== -1) sessionStorage.setItem(chave, posAtual);
      }

      const feedPato    = idLogado ? gerarDecretosPato({ palpites, ranking, posAnterior }) : [];
      const feedPessoal = idLogado ? gerarFeedPessoal(palpites, ranking) : [];
      const feedLiga    = gerarFeedLiga(jogos, ligaAtual);
      const feedSistema = gerarFeedSistema();

      todosFeedItens = [...feedPato, ...feedPessoal, ...feedLiga, ...feedSistema];
      renderizarFeed(todosFeedItens);

    } catch(e) {
      todosFeedItens = [
        {
          tipo: 'pato', icone: 'ü¶Ü', badge: 'Decreto do Pato',
          titulo: 'O Pato est√° offline...',
          descricao: pega(FRASES.offline)(primeiro),
          tempo: 'Agora'
        },
        ...gerarFeedSistema()
      ];
      renderizarFeed(todosFeedItens);
    }
  }

  carregarFeed();
</script>

  <script>
    (function() {
      const nome = localStorage.getItem('nome_craque') || '';
      const foto = localStorage.getItem('foto_craque');
      const userArea = document.getElementById('navbar-user-area');
      if (!userArea) return;
      if (nome) {
        const initials = encodeURIComponent(nome.split(' ')[0]);
        const src = (foto && foto !== 'null' && foto !== 'undefined')
          ? foto
          : `https://ui-avatars.com/api/?name=${initials}&background=7A1E3A&color=fff&size=36`;
        userArea.innerHTML = `
          <a href="perfil.html"><img src="${src}" alt="${nome}" class="navbar-avatar" title="${nome}" onerror="this.src='https://ui-avatars.com/api/?name=${initials}&background=7A1E3A&color=fff&size=36'"></a>
          <button class="btn-logout" onclick="fazerLogout()">Sair</button>`;
      } else {
        userArea.innerHTML = '<a href="login.html" class="btn-logout" style="border-color:var(--accent-cyan);color:var(--accent-cyan);">Entrar</a>';
      }
    })();

    function fazerLogout() { localStorage.clear(); window.location.href = 'inicio.html'; }

    document.addEventListener('DOMContentLoaded', function() {
      const btn = document.getElementById('hamburger-btn');
      const nav = document.querySelector('.nav-links');
      if (btn && nav) btn.addEventListener('click', () => { btn.classList.toggle('aberto'); nav.classList.toggle('aberto'); });
    });
  </script>

</body>
</html>